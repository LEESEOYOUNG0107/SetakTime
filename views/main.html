<!-- 2412_ì„ì†Œì˜ -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SetakTime - ë©”ì¸</title>
  <link rel="stylesheet" href="/style/main.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&family=Noto+Sans+KR:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
  <main class="kiosk-container">
    <div class="logo-area">
      <h1 class="main-title">SetakTime</h1>
      <p class="subtitle">ì‹œì›í•˜ê²Œ! ê°„í¸í•˜ê²Œ! ë‚´ ì„¸íƒ ì‹œê°„ ê´€ë¦¬</p>
    </div>

    <!-- ë¡œê·¸ì¸ ì‹œ ì‚¬ìš©ì ì •ë³´ê°€ í‘œì‹œë  ì˜ì—­ -->
    <div id="user-info-area"></div>

    <!-- ë²„íŠ¼ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë  ì˜ì—­ -->
    <div class="button-area">
      <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ë²„íŠ¼ì´ ì±„ì›Œì§‘ë‹ˆë‹¤. -->
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const buttonArea = document.querySelector('.button-area');
      const userInfoArea = document.getElementById('user-info-area');

      try {
        // ì„œë²„ì— í˜„ì¬ ë¡œê·¸ì¸ëœ ì‚¬ìš©ì ì •ë³´ ìš”ì²­
        const response = await fetch('/api/user-status');

        if (response.ok) {
          // 1. ë¡œê·¸ì¸ì´ ë˜ì–´ ìˆëŠ” ê²½ìš°
          const user = await response.json();

          // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
          const userRole = user.role === 'student' ? 'í•™ìƒ' : (user.role === 'teacher' ? 'ì„ ìƒë‹˜' : 'ê´€ë¦¬ì');
          userInfoArea.innerHTML = `<p class="user-info">${user.username}(${userRole})ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤.</p>`;

          if (user.role === 'teacher') {
            // ì„ ìƒë‹˜ìš© ë©”ë‰´ ë²„íŠ¼
            buttonArea.innerHTML = `
              <a href="/admin_students.html" class="menu-button">ğŸ‘¨â€ğŸ“ í•™ìƒ ê´€ë¦¬</a>
              <a href="/admin_calendar.html" class="menu-button">ğŸ—“ï¸ ìº˜ë¦°ë” ê´€ë¦¬</a>
              <a href="/logout" class="menu-button">ğŸ”‘ ë¡œê·¸ì•„ì›ƒ</a>
            `;
          } else {
            // í•™ìƒìš© ë©”ë‰´ ë²„íŠ¼
            buttonArea.innerHTML = `
              <a href="/reserve" class="menu-button">ğŸ§º ì„¸íƒ ì˜ˆì•½/ì·¨ì†Œ</a>
              <a href="/mypage.html" class="menu-button">ğŸ‘¤ ë§ˆì´í˜ì´ì§€</a>
              <a href="/logout" class="menu-button">ğŸ”‘ ë¡œê·¸ì•„ì›ƒ</a>
            `;
          }

        } else {
          // 2. ë¡œê·¸ì¸ì´ ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°
          buttonArea.innerHTML = `
            <a href="/login.html" class="menu-button">ğŸ”‘ ë¡œê·¸ì¸</a>
            <a href="/signup.html" class="menu-button">ğŸªª íšŒì›ê°€ì…</a>
          `;
        }
      } catch (error) {
        console.error('ì‚¬ìš©ì ìƒíƒœ í™•ì¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
        // ì˜¤ë¥˜ ë°œìƒ ì‹œ ê¸°ë³¸ ë¡œê·¸ì¸/íšŒì›ê°€ì… ë²„íŠ¼ í‘œì‹œ
        buttonArea.innerHTML = `
            <a href="/login.html" class="menu-button">ğŸ”‘ ë¡œê·¸ì¸</a>
            <a href="/signup.html" class="menu-button">ğŸªª íšŒì›ê°€ì…</a>
          `;
      }
    });
  </script>
</body>
</html>
