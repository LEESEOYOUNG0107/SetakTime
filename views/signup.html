<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SetakTime - 회원가입</title>
    <link rel="stylesheet" href="/signup.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Noto+Sans+KR:wght@400;500&display=swap"
        rel="stylesheet">
</head>

<body>
    <header>
        <div class="header-container">
            <h1 class="logo">SetakTime</h1>
            <nav>
                <ul>
                    <li><a href="#">세탁 예약/취소</a></li>
                    <li><a href="login.html">로그인</a></li>
                    <li><a href="signup.html">회원가입</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="signup-container">
            <h2 class="main-logo">SetakTime</h2>
            <div class="signup-box">
                <h3>sign up</h3>
                <form id="signupForm">
                    <input type="text" name="userid" placeholder="Id" required>
                    <input type="password" name="password" placeholder="pw" required>
                    <input type="text" name="username" placeholder="name" required>
                    <input type="text" name="roomnumber" placeholder="room number">
                    <button type="submit" class="btn-ok">Ok</button>
                </form>

                <script>
                    const form = document.getElementById('signupForm');

                    form.addEventListener('submit', function (e) {
                        e.preventDefault(); // 기본 제출 막기

                        const formData = new FormData(form);
                        const data = Object.fromEntries(formData.entries());

                        fetch('/register', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        })
                            .then(res => res.text())
                            .then(resText => {
                                if (resText === 'success') {
                                    alert('회원가입 성공!');
                                    window.location.href = '/login'; // 로그인 페이지로 이동
                                } else {
                                    alert('회원가입 실패: ' + resText);
                                }
                            })
                            .catch(err => {
                                console.error(err);
                                alert('회원가입 중 오류가 발생했습니다.');
                            });
                    });
                </script>


            </div>
        </div>
    </main>
</body>

</html>